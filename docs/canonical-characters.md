Canonical Web Character Editor
==============================

Overview
--------

This repository now treats JSON `CharacterProfile` files in `characters/`
as the **single canonical storage** for Rodent IV characters. Legacy
`personalities/*.txt` files are considered **generated artifacts** for
older GUIs and existing workflows.

Key pieces
----------

- `characters/schema.json` – JSON Schema describing the canonical
  `CharacterProfile` shape, matching the engine's `DumpCharacterJson`
  helper (used via the `characterjson` UCI command).
- `characters/*.json` – one JSON file per character id (for example
  `Simple_1200.json`), each validating against the schema.
- `tools/character-manager/` – small HTTP service that:
  - exposes CRUD operations over `characters/*.json`
  - can export a character to `personalities/<id>.txt`
  - keeps `personalities/characters.txt` aliases in sync on export
- `profiles/` – web-based character editor that:
  - talks to the character manager API for listing, loading, saving,
    adding, copying and deleting characters
  - still provides a local "offline" inspector for raw `characterjson`
    dumps, with a set of `setoption` snippets you can paste into
    personality files

Migration workflow
------------------

1. **Import existing personalities into JSON**
   - Ensure a Rodent executable is available in the repo root
     (for example `rodent-iv-x64.exe` on Windows).
   - From `tools/character-manager/`, run:
     - `npm install`
     - `node migrate.js` or `npm run migrate`
   - The script:
     - iterates over `personalities/characters.txt` aliases and
       `personalities/*.txt`
     - for each personality, runs the engine, calls `ReadPersonality`
       + `characterjson`, and writes a matching `characters/<ID>.json`.

2. **Start the character manager API**
   - From `tools/character-manager/`:
     - `npm start` (or `node server.js`)
   - Open the editor at `http://localhost:4000/`.

3. **Edit characters via the web editor**
   - The left-hand panel lists all characters discovered in
     `characters/*.json`.
   - You can:
     - select a character to load its sheet
     - change high-level strength, book, time and taunt knobs
     - **Save** to persist back to JSON via `PUT /api/characters/:id`
     - **New**, **Duplicate** and **Delete** characters via the API.

4. **Export to legacy personalities (as needed)**
   - For environments that still expect `.txt` personalities:
     - select a character in the editor
     - click **Export to .txt**
   - The manager will:
     - generate a `setoption` script from the active JSON profile
     - write `personalities/<id>.txt`
     - upsert the corresponding entry in `personalities/characters.txt`.

Usage notes
-----------

- The JSON schema is intended to be stable over time. The engine's
  `DumpCharacterJson` helper and the web editor both assume this shape.
- Engine-side loading of JSON profiles is intentionally kept as a future
  enhancement; for now, JSON is the **authoritative configuration**, and
  `.txt` files are exported on demand for GUIs that still rely on them.
- To select a character in a UCI host today, use the existing
  `Personality` / `Character` options, pointing them at the `.txt`
  artifacts generated by the manager.


